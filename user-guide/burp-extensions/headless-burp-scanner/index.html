



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Provides a suite of Burp Suite extensions and a maven plugin to automate security tests using BurpSuite.">
      
      
        <link rel="canonical" href="https://NetsOSS.github.io/headless-burp/user-guide/burp-extensions/headless-burp-scanner/">
      
      
        <meta name="author" content="Anand Sudhir Prayaga">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.3, mkdocs-material-3.0.3">
    
    
      
        <title>Headless Burp Scanner - Headless Burp</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../../#headless-burp-scanner" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://NetsOSS.github.io/headless-burp" title="Headless Burp" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Headless Burp
              </span>
              <span class="md-header-nav__topic">
                Headless Burp Scanner
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/NetsOSS/headless-burp/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      headless-burp
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://NetsOSS.github.io/headless-burp" title="Headless Burp" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Headless Burp
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/NetsOSS/headless-burp/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      headless-burp
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Background
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Background
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../background/background/" title="Background" class="md-nav__link">
      Background
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../background/our-goal/" title="Our Goal" class="md-nav__link">
      Our Goal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../background/burp/" title="Burp" class="md-nav__link">
      Burp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../background/automation/" title="Automation" class="md-nav__link">
      Automation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2" checked>
    
    <label class="md-nav__link" for="nav-4-2">
      Burp Extensions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Burp Extensions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../headless-burp-proxy/" title="Headless Burp Proxy" class="md-nav__link">
      Headless Burp Proxy
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Headless Burp Scanner
      </label>
    
    <a href="./" title="Headless Burp Scanner" class="md-nav__link md-nav__link--active">
      Headless Burp Scanner
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#build" title="Build" class="md-nav__link">
    Build
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" title="Usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-the-extension-jar" title="Using the extension jar" class="md-nav__link">
    Using the extension jar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-extension-from-bapp-store" title="Using the extension from BApp Store" class="md-nav__link">
    Using the extension from BApp Store
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration" title="Configuration" class="md-nav__link">
    Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-line-options" title="Command-line options" class="md-nav__link">
    Command-line options
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scenarios" title="Scenarios" class="md-nav__link">
    Scenarios
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scenario-a-scan-urls-for-security-issues-using-burp" title="Scenario A: Scan URL(s) for security issues using Burp" class="md-nav__link">
    Scenario A: Scan URL(s) for security issues using Burp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-b-scan-urls-for-security-issues-using-burp-but-exclude-scanning-of-certain-paths" title="Scenario B: Scan URL(s) for security issues using Burp but exclude scanning of certain paths" class="md-nav__link">
    Scenario B: Scan URL(s) for security issues using Burp but exclude scanning of certain paths
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-c-scan-urls-for-security-issues-using-burp-but-suppress-false-positives-from-the-scan-report" title="Scenario C: Scan URL(s) for security issues using Burp but suppress false positives from the scan report" class="md-nav__link">
    Scenario C: Scan URL(s) for security issues using Burp but suppress false positives from the scan report
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-d-scan-more-than-just-get-requests-use-requestresponse-data-derived-from-running-functionalintegration-tests-as-input-to-the-scan" title="Scenario D: Scan more than just GET requests - Use request.response data derived from running functional/integration tests as input to the scan" class="md-nav__link">
    Scenario D: Scan more than just GET requests - Use request.response data derived from running functional/integration tests as input to the scan
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tldr" title="tl;dr;" class="md-nav__link">
    tl;dr;
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Maven Plugin
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Maven Plugin
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../maven-plugin/usage/" title="Usage" class="md-nav__link">
      Usage
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../known-issues/" title="Known Issues & Limitations" class="md-nav__link">
      Known Issues & Limitations
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../release-notes/release-notes-1.0/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#build" title="Build" class="md-nav__link">
    Build
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" title="Usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-the-extension-jar" title="Using the extension jar" class="md-nav__link">
    Using the extension jar
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-extension-from-bapp-store" title="Using the extension from BApp Store" class="md-nav__link">
    Using the extension from BApp Store
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration" title="Configuration" class="md-nav__link">
    Configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-line-options" title="Command-line options" class="md-nav__link">
    Command-line options
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scenarios" title="Scenarios" class="md-nav__link">
    Scenarios
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#scenario-a-scan-urls-for-security-issues-using-burp" title="Scenario A: Scan URL(s) for security issues using Burp" class="md-nav__link">
    Scenario A: Scan URL(s) for security issues using Burp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-b-scan-urls-for-security-issues-using-burp-but-exclude-scanning-of-certain-paths" title="Scenario B: Scan URL(s) for security issues using Burp but exclude scanning of certain paths" class="md-nav__link">
    Scenario B: Scan URL(s) for security issues using Burp but exclude scanning of certain paths
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-c-scan-urls-for-security-issues-using-burp-but-suppress-false-positives-from-the-scan-report" title="Scenario C: Scan URL(s) for security issues using Burp but suppress false positives from the scan report" class="md-nav__link">
    Scenario C: Scan URL(s) for security issues using Burp but suppress false positives from the scan report
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scenario-d-scan-more-than-just-get-requests-use-requestresponse-data-derived-from-running-functionalintegration-tests-as-input-to-the-scan" title="Scenario D: Scan more than just GET requests - Use request.response data derived from running functional/integration tests as input to the scan" class="md-nav__link">
    Scenario D: Scan more than just GET requests - Use request.response data derived from running functional/integration tests as input to the scan
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tldr" title="tl;dr;" class="md-nav__link">
    tl;dr;
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/NetsOSS/headless-burp/edit/master/docs/user-guide/burp-extensions/headless-burp-scanner.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="headless-burp-scanner">Headless Burp Scanner<a class="headerlink" href="#headless-burp-scanner" title="Permanent link">&para;</a></h1>
<p>Provides an extension to Burp that allows you to run Burp Suite's Spider and Scanner tools in headless mode via command-line.</p>
<p>However, it can do more!
It can produce a JUnit like report which in turn could instruct the CI server (maybe <a href="https://jenkins.io/">Jenkins</a>) to mark the build as "failed" whenever any vulnerabilities are found. You can also mark some issues as false positives and those will not be reported anymore on the next scan reports. </p>
<h3 id="build">Build<a class="headerlink" href="#build" title="Permanent link">&para;</a></h3>
<p><div class="codehilite"><pre><span></span>./mvnw
</pre></div>
The extension is packaged as a fat jar at target/headless-burp-scanner-master-SNAPSHOT-jar-with-dependencies.jar</p>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<p>Bu8ld the extension as shown above or install it from the <a href="https://portswigger.net/bappstore/d54b11f7af3c4dfeb6b81fb5db72e381">BApp Store</a></p>
<h4 id="using-the-extension-jar">Using the extension jar<a class="headerlink" href="#using-the-extension-jar" title="Permanent link">&para;</a></h4>
<p>On *nix:</p>
<div class="codehilite"><pre><span></span>java -Xmx1G -Djava.awt.headless<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
-classpath headless-burp-scanner-master-SNAPSHOT-jar-with-dependencies.jar:burpsuite_pro_v1.7.31.jar burp.StartBurp <span class="se">\</span>
--unpause-spider-and-scanner <span class="se">\</span>
--project-file<span class="o">=</span>project.burp -c config.xml
</pre></div>

<p>On Cygwin:</p>
<div class="codehilite"><pre><span></span>java -Xmx1G -Djava.awt.headless<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
-classpath <span class="s2">&quot;headless-burp-scanner-master-SNAPSHOT-jar-with-dependencies.jar;burpsuite_pro_v1.7.31.jar&quot;</span> burp.StartBurp <span class="se">\</span>
--unpause-spider-and-scanner <span class="se">\</span>
--project-file<span class="o">=</span>project.burp -c config.xml
</pre></div>

<h4 id="using-the-extension-from-bapp-store">Using the extension from <a href="https://portswigger.net/bappstore/d54b11f7af3c4dfeb6b81fb5db72e381">BApp Store</a><a class="headerlink" href="#using-the-extension-from-bapp-store" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>java -Xmx1G -Djava.awt.headless<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
-classpath burpsuite_pro_v1.7.31.jar burp.StartBurp <span class="se">\</span>
--unpause-spider-and-scanner <span class="se">\</span>
--project-file<span class="o">=</span>project.burp -c config.xml
</pre></div>

<p>On Cygwin:</p>
<div class="codehilite"><pre><span></span>java -Xmx1G -Djava.awt.headless<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
-classpath <span class="s2">&quot;burpsuite_pro_v1.7.31.jar&quot;</span> burp.StartBurp <span class="se">\</span>
--unpause-spider-and-scanner <span class="se">\</span>
--project-file<span class="o">=</span>project.burp -c config.xml
</pre></div>

<h3 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;config</span> <span class="na">xmlns=</span><span class="s">&quot;http://nets.eu/burp/config&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;reportType&gt;</span>HTML<span class="nt">&lt;/reportType&gt;</span> <span class="c">&lt;!-- JUNIT|HTML|XML --&gt;</span>
    <span class="nt">&lt;targetSitemap&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432]]&gt;</span><span class="nt">&lt;/targetSitemap&gt;</span> <span class="c">&lt;!-- atleast one of targetSitemap or scope must be specified --&gt;</span>
    <span class="nt">&lt;scope&gt;</span> <span class="c">&lt;!-- atleast one of targetSitemap or scope must be specified --&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/]]&gt;</span><span class="nt">&lt;/url&gt;</span> <span class="c">&lt;!-- multiple allowed --&gt;</span>
        <span class="nt">&lt;exclusions&gt;</span> <span class="c">&lt;!-- optional --&gt;</span>
            <span class="nt">&lt;exclusion&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/#/logout]]&gt;</span><span class="nt">&lt;/exclusion&gt;</span>
        <span class="nt">&lt;/exclusions&gt;</span>
    <span class="nt">&lt;/scope&gt;</span>
    <span class="nt">&lt;false-positives&gt;</span> <span class="c">&lt;!-- optional --&gt;</span>
        <span class="nt">&lt;issue&gt;</span>
            <span class="nt">&lt;type&gt;</span>5244416<span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;path&gt;</span>.*<span class="nt">&lt;/path&gt;</span>
        <span class="nt">&lt;/issue&gt;</span>
        <span class="nt">&lt;issue&gt;</span>
            <span class="nt">&lt;type&gt;</span>5247488<span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;path&gt;</span>.*bower_components.*<span class="nt">&lt;/path&gt;</span>
        <span class="nt">&lt;/issue&gt;</span>
    <span class="nt">&lt;/false-positives&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>

<p>For an example configuration file, see <a href="https://github.com/NetsOSS/headless-burp/blob/master/headless-burp-scanner/src/test/resources/config.xml">config.xml</a> and <a href="https://github.com/NetsOSS/headless-burp/blob/master/headless-burp-scanner/src/main/resources/headless-burp-scanner-config.xsd">headless-burp-scanner-config.xsd</a> for the xsd</p>
<h3 id="command-line-options">Command-line options<a class="headerlink" href="#command-line-options" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>--project-file=VAL          Open the specified project file; this will be created as a new project if the file does not exist (mandatory)
-c (--config) &lt;file&gt;        Configuration file (mandatory)
-p (--prompt)               Indicates whether to prompt the user to confirm the shutdown (useful for debugging)
-v (--verbose)              Enable verbose output

--diagnostics               Print diagnostic information
--use-defaults              Start with default settings
--collaborator-server       Run in Collaborator server mode
--collaborator-config=VAL   Specify Collaborator server configuration file; defaults to collaborator.config
--config-file=VAL           Load the specified project configuration file(s); this option may be repeated to load multiple files
--user-config-file=VAL      Load the specified user configuration file(s); this option may be repeated to load multiple files
--auto-repair               Automatically repair a corrupted project file specified by the --project-file option
</pre></div>

<h2 id="scenarios">Scenarios<a class="headerlink" href="#scenarios" title="Permanent link">&para;</a></h2>
<p>The extension has been designed to be versatile and support several scenarios</p>
<h3 id="scenario-a-scan-urls-for-security-issues-using-burp">Scenario A: Scan URL(s) for security issues using Burp<a class="headerlink" href="#scenario-a-scan-urls-for-security-issues-using-burp" title="Permanent link">&para;</a></h3>
<ol>
<li>Create a file - config.xml like below and add the URL(s) to be scanned to the scope.</li>
</ol>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;config</span> <span class="na">xmlns=</span><span class="s">&quot;http://nets.eu/burp/config&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;reportType&gt;</span>HTML<span class="nt">&lt;/reportType&gt;</span>
    <span class="nt">&lt;targetSitemap&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432]]&gt;</span><span class="nt">&lt;/targetSitemap&gt;</span>
    <span class="nt">&lt;scope&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/auth]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/users]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/users/1]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/users?search=asd]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/bar/foo]]&gt;</span><span class="nt">&lt;/url&gt;</span>
    <span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>

<ol>
<li>Run as shown in the <a href="#usage">usage</a> section</li>
</ol>
<h3 id="scenario-b-scan-urls-for-security-issues-using-burp-but-exclude-scanning-of-certain-paths">Scenario B: Scan URL(s) for security issues using Burp but exclude scanning of certain paths<a class="headerlink" href="#scenario-b-scan-urls-for-security-issues-using-burp-but-exclude-scanning-of-certain-paths" title="Permanent link">&para;</a></h3>
<ol>
<li>Add an <em>exclusions</em> block to the configuration file.</li>
</ol>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;config</span> <span class="na">xmlns=</span><span class="s">&quot;http://nets.eu/burp/config&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;reportType&gt;</span>HTML<span class="nt">&lt;/reportType&gt;</span>
    <span class="nt">&lt;targetSitemap&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432]]&gt;</span><span class="nt">&lt;/targetSitemap&gt;</span>
    <span class="nt">&lt;scope&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/auth]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/users]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/users/1]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/users?search=asd]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/bar/foo]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;exclusions&gt;</span>
            <span class="nt">&lt;exclusion&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/#/logout]]&gt;</span><span class="nt">&lt;/exclusion&gt;</span>
            <span class="nt">&lt;exclusion&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/#/users/delete]]&gt;</span><span class="nt">&lt;/exclusion&gt;</span>
            <span class="nt">&lt;exclusion&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/#/creepy/crawly]]&gt;</span><span class="nt">&lt;/exclusion&gt;</span>
        <span class="nt">&lt;/exclusions&gt;</span>
    <span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>

<ol>
<li>Run as shown in the <a href="#usage">usage</a> section</li>
</ol>
<h3 id="scenario-c-scan-urls-for-security-issues-using-burp-but-suppress-false-positives-from-the-scan-report">Scenario C: Scan URL(s) for security issues using Burp but suppress false positives from the scan report<a class="headerlink" href="#scenario-c-scan-urls-for-security-issues-using-burp-but-suppress-false-positives-from-the-scan-report" title="Permanent link">&para;</a></h3>
<ol>
<li>Add a <em>false-positives</em> block with the issue type and path <em>(these can be retrieved from a burp scan report)</em> to the configuration file.
You can find more details about <a href="https://portswigger.net/kb/issues">Issue Definitions here</a></li>
</ol>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;config</span> <span class="na">xmlns=</span><span class="s">&quot;http://nets.eu/burp/config&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;reportType&gt;</span>HTML<span class="nt">&lt;/reportType&gt;</span>
    <span class="nt">&lt;targetSitemap&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432]]&gt;</span><span class="nt">&lt;/targetSitemap&gt;</span>
    <span class="nt">&lt;scope&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/auth]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/users]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/users/1]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/users?search=asd]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/bar/foo]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;exclusions&gt;</span>
            <span class="nt">&lt;exclusion&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/#/logout]]&gt;</span><span class="nt">&lt;/exclusion&gt;</span>
            <span class="nt">&lt;exclusion&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/#/users/delete]]&gt;</span><span class="nt">&lt;/exclusion&gt;</span>
            <span class="nt">&lt;exclusion&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/#/creepy/crawly]]&gt;</span><span class="nt">&lt;/exclusion&gt;</span>
        <span class="nt">&lt;/exclusions&gt;</span>
    <span class="nt">&lt;/scope&gt;</span>
    <span class="nt">&lt;false-positives&gt;</span>
        <span class="nt">&lt;issue&gt;</span>
            <span class="nt">&lt;type&gt;</span>5244416<span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;path&gt;</span>.*<span class="nt">&lt;/path&gt;</span>
        <span class="nt">&lt;/issue&gt;</span>
        <span class="nt">&lt;issue&gt;</span>
            <span class="nt">&lt;type&gt;</span>5247488<span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;path&gt;</span>.*bower_components.*<span class="nt">&lt;/path&gt;</span>
        <span class="nt">&lt;/issue&gt;</span>
    <span class="nt">&lt;/false-positives&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>

<ol>
<li>Run as shown in the <a href="#usage">usage</a> section</li>
</ol>
<h3 id="scenario-d-scan-more-than-just-get-requests-use-requestresponse-data-derived-from-running-functionalintegration-tests-as-input-to-the-scan">Scenario D: Scan more than just GET requests - Use request.response data derived from running functional/integration tests as input to the scan<a class="headerlink" href="#scenario-d-scan-more-than-just-get-requests-use-requestresponse-data-derived-from-running-functionalintegration-tests-as-input-to-the-scan" title="Permanent link">&para;</a></h3>
<p>Sometimes, just spidering a target scope and and performing on a scope of URLs doesnt give much value. 
For e.g. when scanning a web application where routing is handled using JavaScript. 
Burp scans can discover more if it can scan more "real-world" requests and responses. 
This way, it can attack the target URLs more effectively and potentially discover more than a <em>shot in the dark</em> spider + scan approach. </p>
<p>To handle such cases, it would be best to let the burp proxy intercept some real traffic to the target and build up a sitemap for itself. 
The <a href="headless-burp-proxy">Headless Burp Proxy</a> extension provides an simple way to achieve this.</p>
<ol>
<li>Follow instructions at <a href="headless-burp-proxy">Headless Burp Proxy</a> and start up burp proxy and remember to set the <code>--project-file</code> option. This is where the "seed" data for scanning is going to be stored.</li>
<li>Configure your functional/integration tests to go through the burp proxy (defaults to <code>4646</code> if you use the extension) by setting HTTP_PROXY or similar.</li>
<li>Run the functional/integration tests against the target.</li>
<li>Create a config.xml with the targetSitemap  (typically, the base URL of the application), scope, exclusions, false-positives etc.</li>
</ol>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;config</span> <span class="na">xmlns=</span><span class="s">&quot;http://nets.eu/burp/config&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;reportType&gt;</span>HTML<span class="nt">&lt;/reportType&gt;</span>
    <span class="nt">&lt;targetSitemap&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432]]&gt;</span><span class="nt">&lt;/targetSitemap&gt;</span>
    <span class="nt">&lt;scope&gt;</span>
        <span class="nt">&lt;url&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432]]&gt;</span><span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;exclusions&gt;</span>
            <span class="nt">&lt;exclusion&gt;</span><span class="cp">&lt;![CDATA[http://localhost:5432/#/logout]]&gt;</span><span class="nt">&lt;/exclusion&gt;</span>
        <span class="nt">&lt;/exclusions&gt;</span>
    <span class="nt">&lt;/scope&gt;</span>
    <span class="nt">&lt;false-positives&gt;</span>
        <span class="nt">&lt;issue&gt;</span>
            <span class="nt">&lt;type&gt;</span>5244416<span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;path&gt;</span>.*<span class="nt">&lt;/path&gt;</span>
        <span class="nt">&lt;/issue&gt;</span>
    <span class="nt">&lt;/false-positives&gt;</span>
<span class="nt">&lt;/config&gt;</span>
</pre></div>

<ol>
<li>Run as shown in the <a href="#usage">usage</a> section and remember to set the <code>--project-file</code> option</li>
</ol>
<h2 id="tldr">tl;dr;<a class="headerlink" href="#tldr" title="Permanent link">&para;</a></h2>
<p>The headless burp scanner plugin can do these</p>
<ul>
<li>Run burp scan in headless or GUI mode</li>
<li>Specify target sitemap and add URL(s) to Burp's target scope</li>
<li>Use the "seed" request/response data generated by any integration/functional tests you might have</li>
<li>Mark issues as false positives, these will not be reported in the scan report anymore.</li>
<li>Spider the target scope.</li>
<li>Actively scan the target scope.</li>
<li>Generate a scan report in JUnit/HTML/XML format.</li>
<li>Shut down Burp</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../headless-burp-proxy/" title="Headless Burp Proxy" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Headless Burp Proxy
              </span>
            </div>
          </a>
        
        
          <a href="../../maven-plugin/usage/" title="Usage" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Usage
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.3",url:{base:"../../.."}})</script>
      
    
    
      
    
  </body>
</html>